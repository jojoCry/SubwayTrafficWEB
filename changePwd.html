<!doctype html>
<html lang="zh-CN">
	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
        <link href="css/mui.min.css" rel="stylesheet"/>
		<script src="js/mui.min.js"></script>
		<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
		<style>
			body{
				background-color: #D0D0D0;
			}
		</style>
	</head>
	<body>
		<form class="mui-input-group" style="margin-top: 10%">
			<div class="mui-input-row">
				<label>用户名</label>
				<input type="text" id="username" placeholder="请输入用户名" />
			</div>
		    <div class="mui-input-row">
		        <label>旧密码</label>
		        <input type="password" id="OldPwd" class="mui-input-password" placeholder="请输入密码" />
		    </div>
			<div class="mui-input-row">
			    <label>新密码</label>
			    <input type="password" id="NewPwd" class="mui-input-password" placeholder="新的密码长度不能小于8位" />
			</div>
		    <div class="mui-button-row">
		        <button type="button" style="width: 30%;" id="submitPwd" class="mui-btn mui-btn-success mui-btn-outlined" > 确认</button>
				<button type="button" style="width: 30%;" id="backBtn" class="mui-btn mui-btn-warning mui-btn-outlined" > 返回</button>
		    </div>
		</form>
	</body>
	<script type="text/javascript" charset="utf-8">
		mui.init();
		$("#backBtn").click(function () {
			window.history.back();
		});

		$("#submitPwd").click(function () {
			const username = $("#username").val();
			const oldPwd = $("#OldPwd").val();
			const newPwd = $("#NewPwd").val();
			$.ajax({
				url: 'http://192.168.0.105:9188/user/v1/modify/password',
				type: 'put',
				data: JSON.stringify({
					"username": username,
					"password": oldPwd,
					"new_password": newPwd
				}),
				contentType: "application/json; charset=UTF-8",
				dataType: "json",
				success: function(){
					mui.alert("密码修改成功", "message");
				},
				error: function(){
					mui.alert("错误的用户名或原密码", "error");
				}
			})
		});
	</script>
</html>
